---
// src/pages/blog/[slug].astro
import { getCollection, getEntry } from 'astro:content'
import Layout from '@/layouts/Layout.astro'
import type { CollectionEntry } from 'astro:content'
import { ArrowLeft, ArrowUpRight } from 'lucide-react'
import { Separator } from '@/components/ui/separator'

export async function getStaticPaths() {
  const all = await getCollection('projects')
  return all.map((p) => ({ params: { slug: p.slug } }))
}

const { slug } = Astro.params
const project = (await getEntry('projects', slug)) as CollectionEntry<'projects'>
const { Content } = await project.render()

const {
  source,
  pubDate = new Date().toISOString(),
  author = 'Unknown',
  authorImg = '/default-avatar.png',
} = project.data

const published = new Date(pubDate).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
})
---

<Layout
  title={project.data.title}
  heroImage="https://github.com/pokepetter/ld44_life_is_currency/blob/master/value_of_life_screenshot.jpg?raw=true"
  heroDesc={project.data.description}
>

  <!-- Post content -->
  <article class="container mx-auto h-full px-6 justify-center py-6">
    <div class="mx-auto bg-white rounded-lg shadow-lg p-6">
        <div class="prose prose-lg max-w-none">
            <!-- byline -->
            <div class="mb-4 flex items-center space-x-2 text-gray-600 text-sm">
                <img
                    src={`/${authorImg}`}
                    alt={author}
                    loading="lazy"
                    class="h-10 w-10 rounded-full ring-2 ring-gray-300"
                />
                <div class="flex items-center space-x-2">
                    <span>By <span class="font-medium text-gray-900">{author}</span></span>
                    <span aria-hidden="true">Â·</span>
                    <time class="">{published}</time>
                </div>
            </div>
            
            <Separator className="my-8" />
            
            <Content />
  
          </div>

      {source && (
        <p class="mt-8 text-sm text-gray-600">
          <a
            href={source}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center space-x-1 underline hover:text-gray-800"
          >
            <span>View source on GitHub</span>
            <ArrowUpRight className="h-4 w-4 inline-block" />
          </a>
        </p>
      )}
      

    <Separator className="my-8" />

    <a
      href="/samples"
      class="flex items-center space-x-2 hover:underline"
    >
      <ArrowLeft className="h-4 w-4 inline-block" />
      <span>Back to Samples</span>
    </a>
  </div>
  
    </div>
  </article>
</Layout>

